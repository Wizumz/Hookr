import{r as u,a as Ge,R as ze}from"./vendor-b1791c80.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();var Se={exports:{}},G={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe=u,Ke=Symbol.for("react.element"),qe=Symbol.for("react.fragment"),Ze=Object.prototype.hasOwnProperty,Qe=Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0};function Me(t,s,a){var n,l={},o=null,i=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(i=s.ref);for(n in s)Ze.call(s,n)&&!et.hasOwnProperty(n)&&(l[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)l[n]===void 0&&(l[n]=s[n]);return{$$typeof:Ke,type:t,key:o,ref:i,props:l,_owner:Qe.current}}G.Fragment=qe;G.jsx=Me;G.jsxs=Me;Se.exports=G;var e=Se.exports,le={},fe=Ge;le.createRoot=fe.createRoot,le.hydrateRoot=fe.hydrateRoot;const pe=["🐟","🎣","🌊","⭐","🔥","💯","👍","🎯","🌟","💪"],tt=()=>pe[Math.floor(Math.random()*pe.length)];function ve(t,s,a,n){const o=(a-t)*Math.PI/180,i=(n-s)*Math.PI/180,c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 3959*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}const S={POSTS:"riprap_posts",COMMENTS:"riprap_comments",VOTES:"riprap_votes",REPORTS:"riprap_reports"},_=t=>{try{const s=localStorage.getItem(t);return s?JSON.parse(s):[]}catch(s){return console.error(`Error reading from localStorage (${t}):`,s),[]}},k=(t,s)=>{try{localStorage.setItem(t,JSON.stringify(s))}catch(a){console.error(`Error saving to localStorage (${t}):`,a)}},je=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),F={async getNearbyPosts(t,s,a=5){try{const l=_(S.POSTS).filter(o=>!o.latitude||!o.longitude?!1:ve(t,s,o.latitude,o.longitude)<=a).map(o=>{const i=ve(t,s,o.latitude,o.longitude);return{...o,distance_miles:Math.round(i*10)/10}});return l.sort((o,i)=>new Date(i.created_at)-new Date(o.created_at)),l}catch(n){return console.error("Error fetching nearby posts:",n),[]}},async createPost(t,s,a,n,l,o=""){try{const i=_(S.POSTS),c={id:je(),content:t,username:s,user_color:a,latitude:n,longitude:l,location_name:o,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),upvotes:0,downvotes:0,vote_count:0,comment_count:0};return i.unshift(c),k(S.POSTS,i),c}catch(i){throw console.error("Error creating post:",i),i}},async getPost(t){try{return _(S.POSTS).find(a=>a.id===t)||null}catch(s){return console.error("Error fetching post:",s),null}},updatePostVoteCounts(t,s,a){try{const n=_(S.POSTS),l=n.findIndex(o=>o.id===t);l!==-1&&(n[l].upvotes=s,n[l].downvotes=a,n[l].vote_count=s-a,n[l].updated_at=new Date().toISOString(),k(S.POSTS,n))}catch(n){console.error("Error updating post vote counts:",n)}},updatePostCommentCount(t,s){try{const a=_(S.POSTS),n=a.findIndex(l=>l.id===t);n!==-1&&(a[n].comment_count=s,a[n].updated_at=new Date().toISOString(),k(S.POSTS,a))}catch(a){console.error("Error updating post comment count:",a)}}},te={async getComments(t){try{return _(S.COMMENTS).filter(a=>a.post_id===t).sort((a,n)=>new Date(a.created_at)-new Date(n.created_at))}catch(s){return console.error("Error fetching comments:",s),[]}},async createComment(t,s,a,n){try{const l=_(S.COMMENTS),o={id:je(),post_id:t,content:s,username:a,user_color:n,emoji_identifier:tt(),created_at:new Date().toISOString()};l.push(o),k(S.COMMENTS,l);const i=l.filter(c=>c.post_id===t);return F.updatePostCommentCount(t,i.length),o}catch(l){throw console.error("Error creating comment:",l),l}}},Ne={async getUserVote(t,s){try{const n=_(S.VOTES).find(l=>l.post_id===t&&l.user_device_id===s);return(n==null?void 0:n.vote_type)||0}catch(a){return console.error("Error fetching user vote:",a),0}},async castVote(t,s,a){try{const n=_(S.VOTES),l=n.findIndex(g=>g.post_id===t&&g.user_device_id===s);if(a===0)l!==-1&&n.splice(l,1);else{const g={post_id:t,user_device_id:s,vote_type:a,created_at:new Date().toISOString()};l!==-1?n[l]=g:n.push(g)}k(S.VOTES,n);const o=n.filter(g=>g.post_id===t),i=o.filter(g=>g.vote_type===1).length,c=o.filter(g=>g.vote_type===-1).length;return F.updatePostVoteCounts(t,i,c),!0}catch(n){throw console.error("Error casting vote:",n),n}},async getVotesForPosts(t,s){try{const a=_(S.VOTES),n={};return a.forEach(l=>{t.includes(l.post_id)&&l.user_device_id===s&&(n[l.post_id]=l.vote_type)}),n}catch(a){return console.error("Error fetching votes for posts:",a),{}}}},ae={subscribeToNearbyPosts(t,s,a,n,l){return{unsubscribe:()=>{}}},subscribeToComments(t,s){return{unsubscribe:()=>{}}},unsubscribe(t){t&&t.unsubscribe&&t.unsubscribe()}},H={"montauk-point-ny":{lat:41.0362,lng:-71.8562,name:"Montauk Point, NY",state:"NY"},"cape-cod-ma":{lat:41.6688,lng:-70.2962,name:"Cape Cod, MA",state:"MA"},"block-island-ri":{lat:41.1775,lng:-71.5773,name:"Block Island, RI",state:"RI"},"chesapeake-bay-md":{lat:38.9784,lng:-76.4951,name:"Chesapeake Bay, MD",state:"MD"},"sandy-hook-nj":{lat:40.4168,lng:-74.0018,name:"Sandy Hook, NJ",state:"NJ"},"orient-point-ny":{lat:41.1615,lng:-72.2351,name:"Orient Point, NY",state:"NY"},"race-point-ma":{lat:42.0654,lng:-70.2457,name:"Race Point, MA",state:"MA"},"watch-hill-ri":{lat:41.3079,lng:-71.8565,name:"Watch Hill, RI",state:"RI"},"martha-vineyard-ma":{lat:41.3888,lng:-70.642,name:"Martha's Vineyard, MA",state:"MA"},"nantucket-ma":{lat:41.2835,lng:-70.0995,name:"Nantucket, MA",state:"MA"},"long-island-sound-ct":{lat:41.1015,lng:-72.6732,name:"Long Island Sound, CT",state:"CT"},"rhode-island-sound-ri":{lat:41.4221,lng:-71.4774,name:"Rhode Island Sound, RI",state:"RI"},"buzzards-bay-ma":{lat:41.5389,lng:-70.9481,name:"Buzzards Bay, MA",state:"MA"},"delaware-bay-de":{lat:38.9108,lng:-75.1818,name:"Delaware Bay, DE",state:"DE"},"hudson-river-ny":{lat:41.7658,lng:-73.9776,name:"Hudson River, NY",state:"NY"}},re=[{name:"Boston",state:"MA",lat:42.3601,lng:-71.0589},{name:"Cambridge",state:"MA",lat:42.3736,lng:-71.1097},{name:"Worcester",state:"MA",lat:42.2626,lng:-71.8023},{name:"Springfield",state:"MA",lat:42.1015,lng:-72.5898},{name:"Lowell",state:"MA",lat:42.6334,lng:-71.3162},{name:"Brockton",state:"MA",lat:42.0834,lng:-71.0184},{name:"New Bedford",state:"MA",lat:41.6362,lng:-70.9342},{name:"Quincy",state:"MA",lat:42.2529,lng:-71.0023},{name:"Lynn",state:"MA",lat:42.4668,lng:-70.9495},{name:"Fall River",state:"MA",lat:41.7015,lng:-71.155},{name:"Newton",state:"MA",lat:42.337,lng:-71.2092},{name:"Somerville",state:"MA",lat:42.3876,lng:-71.0995},{name:"Lawrence",state:"MA",lat:42.707,lng:-71.1631},{name:"Framingham",state:"MA",lat:42.3793,lng:-71.4162},{name:"Haverhill",state:"MA",lat:42.7762,lng:-71.0773},{name:"Waltham",state:"MA",lat:42.3765,lng:-71.2356},{name:"Malden",state:"MA",lat:42.4251,lng:-71.0662},{name:"Brookline",state:"MA",lat:42.3317,lng:-71.1211},{name:"Plymouth",state:"MA",lat:41.9584,lng:-70.6673},{name:"Medford",state:"MA",lat:42.4184,lng:-71.1061},{name:"Taunton",state:"MA",lat:41.9001,lng:-71.0897},{name:"Chicopee",state:"MA",lat:42.1487,lng:-72.6078},{name:"Weymouth",state:"MA",lat:42.218,lng:-70.9395},{name:"Revere",state:"MA",lat:42.4084,lng:-71.012},{name:"Peabody",state:"MA",lat:42.5279,lng:-70.9286},{name:"Methuen",state:"MA",lat:42.7262,lng:-71.1909},{name:"Barnstable",state:"MA",lat:41.7003,lng:-70.3002},{name:"Pittsfield",state:"MA",lat:42.4501,lng:-73.2454},{name:"Attleboro",state:"MA",lat:41.9443,lng:-71.2856},{name:"Everett",state:"MA",lat:42.4084,lng:-71.0537},{name:"Salem",state:"MA",lat:42.5195,lng:-70.8967},{name:"Westfield",state:"MA",lat:42.1251,lng:-72.7495},{name:"Leominster",state:"MA",lat:42.5251,lng:-71.7595},{name:"Fitchburg",state:"MA",lat:42.5834,lng:-71.8023},{name:"Beverly",state:"MA",lat:42.5584,lng:-70.88},{name:"Holyoke",state:"MA",lat:42.2043,lng:-72.6162},{name:"Marlborough",state:"MA",lat:42.3459,lng:-71.5523},{name:"Woburn",state:"MA",lat:42.4792,lng:-71.1523},{name:"Chelsea",state:"MA",lat:42.3918,lng:-71.0328},{name:"Gloucester",state:"MA",lat:42.6142,lng:-70.6631},{name:"New York City",state:"NY",lat:40.7128,lng:-74.006},{name:"Buffalo",state:"NY",lat:42.8864,lng:-78.8784},{name:"Rochester",state:"NY",lat:43.1566,lng:-77.6088},{name:"Yonkers",state:"NY",lat:40.9312,lng:-73.8987},{name:"Syracuse",state:"NY",lat:43.0481,lng:-76.1474},{name:"Albany",state:"NY",lat:42.6526,lng:-73.7562},{name:"New Rochelle",state:"NY",lat:40.9115,lng:-73.7823},{name:"Mount Vernon",state:"NY",lat:40.9126,lng:-73.837},{name:"Schenectady",state:"NY",lat:42.8142,lng:-73.9396},{name:"Utica",state:"NY",lat:43.1009,lng:-75.2327},{name:"White Plains",state:"NY",lat:41.034,lng:-73.7629},{name:"Hempstead",state:"NY",lat:40.7062,lng:-73.6187},{name:"Troy",state:"NY",lat:42.7284,lng:-73.6918},{name:"Niagara Falls",state:"NY",lat:43.0962,lng:-79.0377},{name:"Binghamton",state:"NY",lat:42.0987,lng:-75.918},{name:"Freeport",state:"NY",lat:40.6576,lng:-73.5832},{name:"Valley Stream",state:"NY",lat:40.6642,lng:-73.7084},{name:"Long Beach",state:"NY",lat:40.5885,lng:-73.6579},{name:"Watertown",state:"NY",lat:43.9747,lng:-75.9107},{name:"Jamestown",state:"NY",lat:42.097,lng:-79.2353},{name:"New York",state:"NY",lat:40.7128,lng:-74.006},{name:"Bronx",state:"NY",lat:40.8448,lng:-73.8648},{name:"Brooklyn",state:"NY",lat:40.6782,lng:-73.9442},{name:"Queens",state:"NY",lat:40.7282,lng:-73.7949},{name:"Staten Island",state:"NY",lat:40.5795,lng:-74.1502},{name:"Manhattan",state:"NY",lat:40.7831,lng:-73.9712},{name:"Elmira",state:"NY",lat:42.0898,lng:-76.8077},{name:"Tonawanda",state:"NY",lat:43.0126,lng:-78.8803},{name:"Poughkeepsie",state:"NY",lat:41.7004,lng:-73.9209},{name:"Newburgh",state:"NY",lat:41.5034,lng:-74.0104},{name:"Middletown",state:"NY",lat:41.4459,lng:-74.4226},{name:"Bridgeport",state:"CT",lat:41.1865,lng:-73.1952},{name:"New Haven",state:"CT",lat:41.3083,lng:-72.9279},{name:"Hartford",state:"CT",lat:41.7658,lng:-72.6734},{name:"Stamford",state:"CT",lat:41.0534,lng:-73.5387},{name:"Waterbury",state:"CT",lat:41.5581,lng:-73.0515},{name:"Norwalk",state:"CT",lat:41.1175,lng:-73.4079},{name:"Danbury",state:"CT",lat:41.3948,lng:-73.454},{name:"New Britain",state:"CT",lat:41.6612,lng:-72.7795},{name:"West Haven",state:"CT",lat:41.2707,lng:-72.947},{name:"Greenwich",state:"CT",lat:41.0262,lng:-73.6284},{name:"Hamden",state:"CT",lat:41.3959,lng:-72.9248},{name:"Meriden",state:"CT",lat:41.5382,lng:-72.807},{name:"Bristol",state:"CT",lat:41.6712,lng:-72.9493},{name:"West Hartford",state:"CT",lat:41.762,lng:-72.742},{name:"Milford",state:"CT",lat:41.2223,lng:-73.0565},{name:"Middletown",state:"CT",lat:41.5623,lng:-72.6506},{name:"Norwich",state:"CT",lat:41.5242,lng:-72.0759},{name:"New London",state:"CT",lat:41.3556,lng:-72.0995},{name:"Torrington",state:"CT",lat:41.8007,lng:-73.1212},{name:"Fairfield",state:"CT",lat:41.1612,lng:-73.2615},{name:"Providence",state:"RI",lat:41.824,lng:-71.4128},{name:"Cranston",state:"RI",lat:41.7798,lng:-71.4371},{name:"Warwick",state:"RI",lat:41.7001,lng:-71.4162},{name:"Pawtucket",state:"RI",lat:41.8787,lng:-71.3826},{name:"East Providence",state:"RI",lat:41.8137,lng:-71.3701},{name:"Woonsocket",state:"RI",lat:42.0029,lng:-71.5147},{name:"Newport",state:"RI",lat:41.4901,lng:-71.3128},{name:"Central Falls",state:"RI",lat:41.8904,lng:-71.3926},{name:"Westerly",state:"RI",lat:41.3776,lng:-71.827},{name:"Cumberland",state:"RI",lat:41.9665,lng:-71.4326},{name:"Portland",state:"ME",lat:43.6591,lng:-70.2568},{name:"Lewiston",state:"ME",lat:44.1004,lng:-70.2148},{name:"Bangor",state:"ME",lat:44.8016,lng:-68.7712},{name:"South Portland",state:"ME",lat:43.6415,lng:-70.2409},{name:"Auburn",state:"ME",lat:44.0979,lng:-70.2311},{name:"Biddeford",state:"ME",lat:43.4926,lng:-70.4533},{name:"Sanford",state:"ME",lat:43.439,lng:-70.774},{name:"Saco",state:"ME",lat:43.5009,lng:-70.4428},{name:"Augusta",state:"ME",lat:44.3106,lng:-69.7795},{name:"Westbrook",state:"ME",lat:43.677,lng:-70.3712},{name:"Waterville",state:"ME",lat:44.5323,lng:-69.6317},{name:"Presque Isle",state:"ME",lat:46.6811,lng:-68.0161},{name:"Bar Harbor",state:"ME",lat:44.3876,lng:-68.2039},{name:"Calais",state:"ME",lat:45.1737,lng:-67.2741},{name:"Ellsworth",state:"ME",lat:44.5434,lng:-68.4198},{name:"Manchester",state:"NH",lat:42.9956,lng:-71.4548},{name:"Nashua",state:"NH",lat:42.7654,lng:-71.4676},{name:"Concord",state:"NH",lat:43.2081,lng:-71.5376},{name:"Derry",state:"NH",lat:42.8804,lng:-71.3273},{name:"Dover",state:"NH",lat:43.1979,lng:-70.8737},{name:"Rochester",state:"NH",lat:43.3042,lng:-70.9759},{name:"Salem",state:"NH",lat:42.7876,lng:-71.2009},{name:"Merrimack",state:"NH",lat:42.8659,lng:-71.4995},{name:"Hudson",state:"NH",lat:42.7659,lng:-71.4342},{name:"Londonderry",state:"NH",lat:42.8653,lng:-71.3739},{name:"Keene",state:"NH",lat:42.9342,lng:-72.2815},{name:"Portsmouth",state:"NH",lat:43.0718,lng:-70.7626},{name:"Laconia",state:"NH",lat:43.5276,lng:-71.4703},{name:"Hampton",state:"NH",lat:42.9373,lng:-70.8187},{name:"Burlington",state:"VT",lat:44.4759,lng:-73.2121},{name:"Essex",state:"VT",lat:44.4906,lng:-73.1129},{name:"South Burlington",state:"VT",lat:44.4669,lng:-73.1709},{name:"Colchester",state:"VT",lat:44.5434,lng:-73.1317},{name:"Rutland",state:"VT",lat:43.6106,lng:-72.9726},{name:"Bennington",state:"VT",lat:42.8781,lng:-73.1968},{name:"Brattleboro",state:"VT",lat:42.8509,lng:-72.5579},{name:"Milton",state:"VT",lat:44.6365,lng:-73.1151},{name:"Hartford",state:"VT",lat:43.6506,lng:-72.319},{name:"Williston",state:"VT",lat:44.4434,lng:-73.0934},{name:"Middlebury",state:"VT",lat:44.0154,lng:-73.1673},{name:"Montpelier",state:"VT",lat:44.2601,lng:-72.5806},{name:"Philadelphia",state:"PA",lat:39.9526,lng:-75.1652},{name:"Pittsburgh",state:"PA",lat:40.4406,lng:-79.9959},{name:"Allentown",state:"PA",lat:40.6084,lng:-75.4901},{name:"Erie",state:"PA",lat:42.1292,lng:-80.0851},{name:"Reading",state:"PA",lat:40.3356,lng:-75.9269},{name:"Scranton",state:"PA",lat:41.409,lng:-75.6624},{name:"Bethlehem",state:"PA",lat:40.6259,lng:-75.3704},{name:"Lancaster",state:"PA",lat:40.0379,lng:-76.3055},{name:"Harrisburg",state:"PA",lat:40.2732,lng:-76.8839},{name:"York",state:"PA",lat:39.9626,lng:-76.7277},{name:"Altoona",state:"PA",lat:40.5187,lng:-78.3947},{name:"Wilkes-Barre",state:"PA",lat:41.2459,lng:-75.8813},{name:"Newark",state:"NJ",lat:40.7357,lng:-74.1724},{name:"Jersey City",state:"NJ",lat:40.7178,lng:-74.0431},{name:"Paterson",state:"NJ",lat:40.9168,lng:-74.1718},{name:"Elizabeth",state:"NJ",lat:40.664,lng:-74.2107},{name:"Edison",state:"NJ",lat:40.5187,lng:-74.4121},{name:"Woodbridge",state:"NJ",lat:40.5576,lng:-74.2846},{name:"Lakewood",state:"NJ",lat:40.0979,lng:-74.2179},{name:"Toms River",state:"NJ",lat:39.9537,lng:-74.1979},{name:"Hamilton",state:"NJ",lat:40.229,lng:-74.6598},{name:"Trenton",state:"NJ",lat:40.2206,lng:-74.7565},{name:"Camden",state:"NJ",lat:39.9259,lng:-75.1196},{name:"Clifton",state:"NJ",lat:40.8584,lng:-74.1638},{name:"Brick",state:"NJ",lat:40.0473,lng:-74.1354},{name:"Cherry Hill",state:"NJ",lat:39.9348,lng:-75.0307},{name:"Passaic",state:"NJ",lat:40.8568,lng:-74.1279},{name:"Union City",state:"NJ",lat:40.7662,lng:-74.0243},{name:"Bayonne",state:"NJ",lat:40.6687,lng:-74.1143},{name:"East Orange",state:"NJ",lat:40.7668,lng:-74.2049},{name:"Vineland",state:"NJ",lat:39.4864,lng:-75.026},{name:"New Brunswick",state:"NJ",lat:40.4862,lng:-74.4518},{name:"Hoboken",state:"NJ",lat:40.7439,lng:-74.0324},{name:"Plainfield",state:"NJ",lat:40.6337,lng:-74.4071},{name:"West New York",state:"NJ",lat:40.7878,lng:-74.0143},{name:"Hackensack",state:"NJ",lat:40.8859,lng:-74.0437},{name:"Sayreville",state:"NJ",lat:40.4595,lng:-74.3612},{name:"Kearny",state:"NJ",lat:40.7684,lng:-74.1454},{name:"Linden",state:"NJ",lat:40.622,lng:-74.2446},{name:"Atlantic City",state:"NJ",lat:39.3643,lng:-74.4229},{name:"Baltimore",state:"MD",lat:39.2904,lng:-76.6122},{name:"Columbia",state:"MD",lat:39.2037,lng:-76.861},{name:"Germantown",state:"MD",lat:39.1731,lng:-77.2717},{name:"Silver Spring",state:"MD",lat:38.9912,lng:-77.0261},{name:"Waldorf",state:"MD",lat:38.6206,lng:-76.9391},{name:"Glen Burnie",state:"MD",lat:39.1626,lng:-76.6247},{name:"Ellicott City",state:"MD",lat:39.2673,lng:-76.7983},{name:"Frederick",state:"MD",lat:39.4143,lng:-77.4105},{name:"Dundalk",state:"MD",lat:39.2709,lng:-76.5219},{name:"Rockville",state:"MD",lat:39.084,lng:-77.1528},{name:"Bethesda",state:"MD",lat:38.9807,lng:-77.102},{name:"Gaithersburg",state:"MD",lat:39.1434,lng:-77.2014},{name:"Annapolis",state:"MD",lat:38.9717,lng:-76.501},{name:"Bowie",state:"MD",lat:38.9426,lng:-76.7302},{name:"Hagerstown",state:"MD",lat:39.6418,lng:-77.72},{name:"Cumberland",state:"MD",lat:39.6526,lng:-78.7625},{name:"Salisbury",state:"MD",lat:38.3607,lng:-75.5994},{name:"Ocean City",state:"MD",lat:38.3365,lng:-75.0849},{name:"Washington",state:"DC",lat:38.9072,lng:-77.0369},{name:"Wilmington",state:"DE",lat:39.7391,lng:-75.5398},{name:"Dover",state:"DE",lat:39.1612,lng:-75.5264},{name:"Newark",state:"DE",lat:39.6837,lng:-75.7497},{name:"Middletown",state:"DE",lat:39.4495,lng:-75.7163},{name:"Smyrna",state:"DE",lat:39.2998,lng:-75.6046},{name:"Milford",state:"DE",lat:38.9129,lng:-75.4277},{name:"Seaford",state:"DE",lat:38.6412,lng:-75.611},{name:"Georgetown",state:"DE",lat:38.6901,lng:-75.3855},{name:"Elsmere",state:"DE",lat:39.7379,lng:-75.5924},{name:"New Castle",state:"DE",lat:39.662,lng:-75.5664},{name:"Chicago",state:"IL",lat:41.8781,lng:-87.6298},{name:"Los Angeles",state:"CA",lat:34.0522,lng:-118.2437},{name:"Houston",state:"TX",lat:29.7604,lng:-95.3698},{name:"Phoenix",state:"AZ",lat:33.4484,lng:-112.074},{name:"San Antonio",state:"TX",lat:29.4241,lng:-98.4936},{name:"San Diego",state:"CA",lat:32.7157,lng:-117.1611},{name:"Dallas",state:"TX",lat:32.7767,lng:-96.797},{name:"San Jose",state:"CA",lat:37.3382,lng:-121.8863},{name:"Austin",state:"TX",lat:30.2672,lng:-97.7431},{name:"Jacksonville",state:"FL",lat:30.3322,lng:-81.6557},{name:"Fort Worth",state:"TX",lat:32.7555,lng:-97.3308},{name:"Columbus",state:"OH",lat:39.9612,lng:-82.9988},{name:"San Francisco",state:"CA",lat:37.7749,lng:-122.4194},{name:"Charlotte",state:"NC",lat:35.2271,lng:-80.8431},{name:"Indianapolis",state:"IN",lat:39.7684,lng:-86.1581},{name:"Seattle",state:"WA",lat:47.6062,lng:-122.3321},{name:"Denver",state:"CO",lat:39.7392,lng:-104.9903},{name:"Detroit",state:"MI",lat:42.3314,lng:-83.0458},{name:"Nashville",state:"TN",lat:36.1627,lng:-86.7816},{name:"Memphis",state:"TN",lat:35.1495,lng:-90.049},{name:"Portland",state:"OR",lat:45.5152,lng:-122.6784},{name:"Oklahoma City",state:"OK",lat:35.4676,lng:-97.5164},{name:"Las Vegas",state:"NV",lat:36.1699,lng:-115.1398},{name:"Louisville",state:"KY",lat:38.2527,lng:-85.7585},{name:"Milwaukee",state:"WI",lat:43.0389,lng:-87.9065},{name:"Albuquerque",state:"NM",lat:35.0844,lng:-106.6504},{name:"Tucson",state:"AZ",lat:32.2226,lng:-110.9747},{name:"Fresno",state:"CA",lat:36.7378,lng:-119.7871},{name:"Sacramento",state:"CA",lat:38.5816,lng:-121.4944},{name:"Kansas City",state:"MO",lat:39.0997,lng:-94.5786},{name:"Mesa",state:"AZ",lat:33.4152,lng:-111.8315},{name:"Virginia Beach",state:"VA",lat:36.8529,lng:-75.978},{name:"Atlanta",state:"GA",lat:33.749,lng:-84.388},{name:"Colorado Springs",state:"CO",lat:38.8339,lng:-104.8214},{name:"Omaha",state:"NE",lat:41.2565,lng:-95.9345},{name:"Raleigh",state:"NC",lat:35.7796,lng:-78.6382},{name:"Miami",state:"FL",lat:25.7617,lng:-80.1918},{name:"Long Beach",state:"CA",lat:33.7701,lng:-118.1937},{name:"Virginia Beach",state:"VA",lat:36.8529,lng:-75.978},{name:"Oakland",state:"CA",lat:37.8044,lng:-122.2712},{name:"Minneapolis",state:"MN",lat:44.9778,lng:-93.265},{name:"Tulsa",state:"OK",lat:36.154,lng:-95.9928},{name:"Arlington",state:"TX",lat:32.7357,lng:-97.1081},{name:"Tampa",state:"FL",lat:27.9506,lng:-82.4572},{name:"New Orleans",state:"LA",lat:29.9511,lng:-90.0715},{name:"Wichita",state:"KS",lat:37.6872,lng:-97.3301},{name:"Cleveland",state:"OH",lat:41.4993,lng:-81.6944},{name:"Bakersfield",state:"CA",lat:35.3733,lng:-119.0187},{name:"Aurora",state:"CO",lat:39.7294,lng:-104.8319},{name:"Anaheim",state:"CA",lat:33.8366,lng:-117.9143},{name:"Honolulu",state:"HI",lat:21.3099,lng:-157.8581},{name:"Santa Ana",state:"CA",lat:33.7455,lng:-117.8677},{name:"Corpus Christi",state:"TX",lat:27.8006,lng:-97.3964},{name:"Riverside",state:"CA",lat:33.9533,lng:-117.3962},{name:"Lexington",state:"KY",lat:38.0406,lng:-84.5037},{name:"Stockton",state:"CA",lat:37.9577,lng:-121.2908},{name:"St. Paul",state:"MN",lat:44.9537,lng:-93.09},{name:"St. Louis",state:"MO",lat:38.627,lng:-90.1994},{name:"Pittsburgh",state:"PA",lat:40.4406,lng:-79.9959},{name:"Anchorage",state:"AK",lat:61.2181,lng:-149.9003},{name:"Cincinnati",state:"OH",lat:39.1031,lng:-84.512},{name:"Henderson",state:"NV",lat:36.0395,lng:-114.9817},{name:"Greensboro",state:"NC",lat:36.0726,lng:-79.792},{name:"Plano",state:"TX",lat:33.0198,lng:-96.6989},{name:"Newark",state:"NJ",lat:40.7357,lng:-74.1724},{name:"Lincoln",state:"NE",lat:40.8136,lng:-96.7026},{name:"Toledo",state:"OH",lat:41.6528,lng:-83.5379},{name:"Orlando",state:"FL",lat:28.5383,lng:-81.3792},{name:"Chula Vista",state:"CA",lat:32.6401,lng:-117.0842},{name:"Jersey City",state:"NJ",lat:40.7178,lng:-74.0431},{name:"Chandler",state:"AZ",lat:33.3062,lng:-111.8413},{name:"Laredo",state:"TX",lat:27.5306,lng:-99.4803},{name:"Madison",state:"WI",lat:43.0731,lng:-89.4012},{name:"Lubbock",state:"TX",lat:33.5779,lng:-101.8552},{name:"Winston-Salem",state:"NC",lat:36.0999,lng:-80.2442},{name:"Garland",state:"TX",lat:32.9126,lng:-96.6389},{name:"Glendale",state:"AZ",lat:33.5387,lng:-112.186},{name:"Hialeah",state:"FL",lat:25.8576,lng:-80.2781},{name:"Reno",state:"NV",lat:39.5296,lng:-119.8138},{name:"Baton Rouge",state:"LA",lat:30.4515,lng:-91.1871},{name:"Irvine",state:"CA",lat:33.6846,lng:-117.8265},{name:"Chesapeake",state:"VA",lat:36.7682,lng:-76.2875},{name:"Irving",state:"TX",lat:32.814,lng:-96.9489},{name:"Scottsdale",state:"AZ",lat:33.4942,lng:-111.9261},{name:"North Las Vegas",state:"NV",lat:36.1989,lng:-115.1175},{name:"Fremont",state:"CA",lat:37.5485,lng:-121.9886},{name:"Gilbert",state:"AZ",lat:33.3528,lng:-111.789},{name:"San Bernardino",state:"CA",lat:34.1083,lng:-117.2898},{name:"Boise",state:"ID",lat:43.615,lng:-116.2023},{name:"Birmingham",state:"AL",lat:33.5207,lng:-86.8025}],ye=t=>{if(!t||t.length<1)return[];const s=t.toLowerCase().trim();return re.map(n=>{const l=n.name.toLowerCase(),o=n.state.toLowerCase(),i=`${n.name}, ${n.state}`.toLowerCase();let c=0;return l===s&&(c+=100),i===s&&(c+=95),l.startsWith(s)&&(c+=50),o.startsWith(s)&&(c+=30),l.includes(s)&&(c+=20),o.includes(s)&&(c+=10),i.includes(s)&&(c+=15),{...n,score:c}}).filter(n=>n.score>0).sort((n,l)=>l.score-n.score).slice(0,15)},at=async t=>{try{const a=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&countrycodes=us&limit=5&q=${encodeURIComponent(t)}`)).json();if(a&&a.length>0)return a.map(n=>{var l;return{name:n.display_name.split(",")[0],state:((l=n.display_name.split(",")[1])==null?void 0:l.trim())||"Unknown",lat:parseFloat(n.lat),lng:parseFloat(n.lon)}})}catch(s){console.error("Geocoding API error:",s)}return[]},nt=()=>{let t=localStorage.getItem("riprap_device_id");return t||(t=crypto.randomUUID(),localStorage.setItem("riprap_device_id",t)),t},oe=()=>{const t=["REEL","BIG","DEEP","LUCKY","MASTER","PRO","BASS","CATCH","FISHER","ANGLER"],s=["FISHER","CASTER","HUNTER","MASTER","CAPTAIN","ADMIRAL","SAILOR","KEEPER","LEGEND","HERO"],a=Math.floor(Math.random()*999)+1,n=t[Math.floor(Math.random()*t.length)],l=s[Math.floor(Math.random()*s.length)];return`${n}${l}${a}`},U=[{name:"Navy",value:"#1e3a8a",textClass:"text-blue-800"},{name:"Purple",value:"#7c3aed",textClass:"text-purple-600"},{name:"Green",value:"#059669",textClass:"text-emerald-600"},{name:"Orange",value:"#ea580c",textClass:"text-orange-600"},{name:"Red",value:"#dc2626",textClass:"text-red-600"},{name:"Teal",value:"#0d9488",textClass:"text-teal-600"},{name:"Pink",value:"#db2777",textClass:"text-pink-600"},{name:"Indigo",value:"#4338ca",textClass:"text-indigo-600"}],st=(t=null,s=null)=>{let a=localStorage.getItem("riprap_user");if(!a||t){const n=U[0];a={id:crypto.randomUUID(),screenName:t||oe(),color:s||n,hasChangedName:!!t,createdAt:new Date().toISOString()},localStorage.setItem("riprap_user",JSON.stringify(a))}else a=JSON.parse(a),a.color||(a.color=U[0],localStorage.setItem("riprap_user",JSON.stringify(a)));return a},ne=(t,s)=>{const a={customLocation:t,locationRadius:s,savedAt:new Date().toISOString()};localStorage.setItem("riprap_location_settings",JSON.stringify(a))},be=()=>{const t=localStorage.getItem("riprap_location_settings");return t?JSON.parse(t):{customLocation:null,locationRadius:10}},D=(t,s,a,n)=>{const o=(a-t)*Math.PI/180,i=(n-s)*Math.PI/180,c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 3959*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},$={POST_COOLDOWN:3e4,VOTE_COOLDOWN:1e3,MAX_POSTS_PER_HOUR:10,MAX_VOTES_PER_MINUTE:30},we=(t,s,a,n,l)=>{const i=Date.now()-t;return i<s?{allowed:!1,remainingTime:Math.ceil((s-i)/1e3)}:a>=n?{allowed:!1,remainingTime:Math.ceil(l/1e3)}:{allowed:!0,remainingTime:0}},lt=["spam","scam","fake","bot","hack","cheat","exploit","idiot","stupid","hate","kill","die","suicide","buy now","click here","make money","get rich","free money"],ot=[/(.)\1{4,}/g,/[A-Z]{10,}/g,/https?:\/\/[^\s]+/g,/\d{10,}/g,/[!@#$%^&*]{3,}/g],rt=t=>{const s=t.toLowerCase(),a=[],n=lt.filter(c=>s.includes(c));n.length>0&&a.push(`Contains inappropriate words: ${n.join(", ")}`),ot.forEach(c=>{c.test(t)&&a.push("Contains suspicious patterns")}),t.length<3&&a.push("Content too short");const l=t.split(/\s+/),o={};return l.forEach(c=>{const g=c.toLowerCase().replace(/[^a-z]/g,"");g.length>2&&(o[g]=(o[g]||0)+1)}),Math.max(...Object.values(o))>3&&a.push("Excessive word repetition detected"),{allowed:a.length===0,issues:a,severity:a.length>2?"high":a.length>0?"medium":"low"}},Ce=(t,s)=>{let a=null,n=1/0;return Object.entries(H).forEach(([l,o])=>{const i=D(t,s,o.lat,o.lng);i<n&&(n=i,a=o)}),a?n<=25?a.name:`${Math.round(n)} miles from ${a.name}`:"Unknown Area"},se=(t,s)=>{let a=null,n=1/0;if(re.forEach(o=>{const i=D(t,s,o.lat,o.lng);i<n&&(n=i,a=o)}),a&&n<=50)return`${a.name}, ${a.state}`;let l=null;return n=1/0,Object.entries(H).forEach(([o,i])=>{const c=D(t,s,i.lat,i.lng);c<n&&(n=c,l=i)}),l?l.name:"Unknown Location"},it=`
    o                 o
     \\               /
      \\             /
  ~~~~~~\\~~~~~~~~~~~/~~~~~~
         \\         /
          \\       /
           \\     /
            \\   /
             \\_/
              |
         ____/ \\____
        /           \\
       |   RIPRAP   |
        \\___________/
`,ct=({onUsernameSet:t})=>{const[s,a]=u.useState(oe()),[n,l]=u.useState(U[0]),o=()=>{if(s.trim().length<3){alert("Username must be at least 3 characters");return}if(s.trim().length>20){alert("Username must be 20 characters or less");return}t(s.trim().toUpperCase(),n)},i=()=>{a(oe())};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4 terminal-text",children:e.jsxs("div",{className:"w-full max-w-md mx-auto terminal-card p-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"ascii-art text-xs terminal-accent",children:it}),e.jsx("div",{className:"text-xl font-bold terminal-text",children:"Welcome to RipRap"}),e.jsx("div",{className:"text-sm terminal-text",children:"Choose your angler name to get started"})]}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold terminal-text block",children:"Your angler name:"}),e.jsx("input",{type:"text",value:s,onChange:c=>a(c.target.value.toUpperCase()),placeholder:"Enter username",className:"w-full h-10 px-3 py-2 terminal-input text-sm font-mono focus:outline-none focus:ring-2 focus:ring-navy-700",maxLength:20}),e.jsxs("div",{className:"text-xs terminal-accent",children:[s.length,"/20 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold terminal-text block",children:"Choose your color:"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:U.map(c=>e.jsx("button",{onClick:()=>l(c),className:`h-10 rounded border-2 ${n.name===c.name?"border-navy-700 ring-2 ring-navy-300":"border-gray-300 hover:border-gray-400"} focus:outline-none focus:ring-2 focus:ring-navy-700`,style:{backgroundColor:c.value},title:c.name},c.name))}),e.jsxs("div",{className:"text-xs terminal-accent",children:["Preview: ",e.jsx("span",{className:n.textClass,style:{fontWeight:"bold"},children:s})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-3 text-xs terminal-text",children:["⚠️ ",e.jsx("strong",{children:"Note:"})," You cannot change your username or color after creating your account. Choose carefully!"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:i,className:"h-10 px-3 py-2 terminal-button text-sm font-bold hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-700",children:"Generate New"}),e.jsx("button",{onClick:o,disabled:!s.trim()||s.trim().length<3,className:"h-10 px-3 py-2 terminal-button text-sm font-bold hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-700 disabled:terminal-button:disabled",children:"Start Fishing"})]}),e.jsxs("div",{className:"text-center text-xs terminal-text mt-4 space-y-1",children:[e.jsx("div",{children:"• Anonymous fishing community"}),e.jsx("div",{children:"• Location-based posts"}),e.jsx("div",{children:"• Share catches, spots, and tips"})]})]})]})})},mt=({isOpen:t,onClose:s,user:a,userStats:n})=>{var l;return t?e.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"w-full max-w-md terminal-card p-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-lg font-bold terminal-text",children:"My Account"}),e.jsx("div",{className:"text-xs terminal-accent mt-1",children:"Device-based account"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-navy-50 p-4 rounded border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold",style:{color:((l=a==null?void 0:a.color)==null?void 0:l.value)||"#1e3a8a"},children:a==null?void 0:a.screenName}),e.jsxs("div",{className:"text-xs terminal-accent mt-1",children:["Angler since ",new Date((a==null?void 0:a.createdAt)||Date.now()).toLocaleDateString()]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded text-center",children:[e.jsx("div",{className:"text-lg font-bold terminal-text",children:n.posts.length}),e.jsx("div",{className:"text-xs terminal-accent",children:"Posts"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded text-center",children:[e.jsx("div",{className:"text-lg font-bold terminal-text",children:n.comments.length}),e.jsx("div",{className:"text-xs terminal-accent",children:"Comments"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-bold terminal-text",children:"Recent Posts"}),e.jsxs("div",{className:"max-h-40 overflow-y-auto space-y-2",children:[n.posts.slice(0,5).map((o,i)=>e.jsxs("div",{className:"bg-gray-50 p-2 rounded text-xs",children:[e.jsx("div",{className:"font-mono",children:o.content}),e.jsxs("div",{className:"text-gray-500 mt-1",children:["▲ ",o.upvotes||0," ▼ ",o.downvotes||0]})]},i)),n.posts.length===0&&e.jsx("div",{className:"text-xs terminal-accent text-center py-4",children:"No posts yet. Start sharing your catches!"})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-3 text-xs",children:[e.jsx("div",{className:"font-bold text-yellow-800 mb-2",children:"Account Persistence"}),e.jsxs("div",{className:"text-yellow-700 space-y-1",children:[e.jsx("div",{children:"• Account saved to this device"}),e.jsx("div",{children:"• Clear cache = lose account"}),e.jsx("div",{children:"• Different device = new account"})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{onClick:s,className:"w-full h-10 px-3 py-2 border-2 border-navy-700 bg-white text-navy-700 text-sm font-bold hover:bg-navy-50 focus:outline-none focus:ring-2 focus:ring-navy-700",children:"Close"})})]})]})}):null},dt=({isOpen:t,onClose:s,onLocationSet:a,currentLocation:n})=>{const[l,o]=u.useState("");u.useState("");const[i,c]=u.useState(!1),[g,M]=u.useState([]),[v,w]=u.useState(!1);if(!t)return null;const R=x=>{if(o(x),x.length>=1){const C=ye(x);M(C),w(C.length>0)}else M([]),w(!1)},T=x=>{o(`${x.name}, ${x.state}`),M([]),w(!1),a({lat:x.lat,lng:x.lng,name:`${x.name}, ${x.state}`}),s()},L=async()=>{if(!l.trim()){alert("Please enter a city name");return}c(!0);const x=re.find(p=>`${p.name}, ${p.state}`.toLowerCase()===l.toLowerCase()||p.name.toLowerCase()===l.toLowerCase());if(x){a({lat:x.lat,lng:x.lng,name:`${x.name}, ${x.state}`}),s(),c(!1);return}const C=ye(l);if(C.length>0&&C[0].score>50){const p=C[0];a({lat:p.lat,lng:p.lng,name:`${p.name}, ${p.state}`}),s(),c(!1);return}try{const p=await at(l);if(p.length>0){const y=p[0];a({lat:y.lat,lng:y.lng,name:`${y.name}, ${y.state}`}),s(),c(!1);return}}catch(p){console.error("API geocoding failed:",p)}c(!1),alert("City not found. Please check spelling or select from autocomplete suggestions.")},O=[{id:"current",name:"Use Current Location",coords:null},...Object.entries(H).map(([x,C])=>({id:x,name:C.name,coords:C}))],N=x=>{x.id==="current"?a(null):a(x.coords),s()};return e.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"w-full max-w-md terminal-card p-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-lg font-bold terminal-text",children:"Set Location"}),e.jsx("div",{className:"text-xs terminal-accent mt-1",children:"Choose where to view fishing posts"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center text-xs terminal-accent",children:"Select a location:"}),e.jsxs("div",{className:"space-y-2 relative",children:[e.jsx("label",{className:"text-sm font-bold terminal-text block",children:"Enter City, State:"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:l,onChange:x=>R(x.target.value),placeholder:"Boston, MA",className:"flex-1 h-10 px-3 py-2 terminal-input text-sm focus:outline-none focus:ring-2 focus:ring-navy-700",onFocus:()=>l.length>=1&&w(g.length>0),onBlur:()=>setTimeout(()=>w(!1),200),onKeyPress:x=>x.key==="Enter"&&L()}),e.jsx("button",{onClick:L,disabled:!l.trim()||i,className:"px-4 py-2 terminal-button text-sm font-bold hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-700 disabled:opacity-50",children:i?"...":"Set"})]}),v&&g.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-48 overflow-y-auto",children:g.map((x,C)=>e.jsxs("button",{onClick:()=>T(x),className:"w-full text-left px-3 py-2 text-sm hover:bg-navy-50 border-b border-gray-100 last:border-b-0",children:[x.name,", ",x.state]},C))})]}),e.jsx("div",{className:"text-center text-xs terminal-accent",children:"or choose a fishing hotspot:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold terminal-text block",children:"Northeast Striped Bass Locations:"}),e.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:O.map(x=>e.jsx("button",{onClick:()=>N(x),className:"w-full text-left px-3 py-2 text-sm hover:bg-navy-50 border border-gray-300 hover:border-navy-300 focus:outline-none focus:ring-2 focus:ring-navy-700",children:x.name},x.id))})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{onClick:s,className:"w-full h-10 px-3 py-2 border-2 border-navy-700 bg-white text-navy-700 text-sm font-bold hover:bg-navy-50 focus:outline-none focus:ring-2 focus:ring-navy-700",children:"Cancel"})})]})]})})},gt=({isOpen:t,onClose:s,onSubmit:a,newPostContent:n,setNewPostContent:l,isOnline:o})=>{if(!t)return null;const i=()=>{n.trim()&&(a(),s())};return e.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"w-full max-w-md terminal-card p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:n,onChange:c=>l(c.target.value),placeholder:"Post your weather and/or fishing reports, questions from the water, callouts of bad behavior...",className:"w-full h-24 px-3 py-2 terminal-input text-sm font-mono resize-none focus:outline-none focus:ring-2 focus:ring-navy-700",maxLength:200,autoFocus:!0}),e.jsxs("div",{className:"text-xs terminal-accent",children:[n.length,"/200 characters"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:s,className:"h-10 px-3 py-2 border-2 border-navy-700 bg-white text-navy-700 text-sm font-bold hover:bg-navy-50 focus:outline-none focus:ring-2 focus:ring-navy-700",children:"Cancel"}),e.jsx("button",{onClick:i,disabled:!n.trim()||!o,className:"h-10 px-3 py-2 terminal-button text-sm font-bold hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-700 disabled:terminal-button:disabled",children:"Post"})]})]})})})},ut=({post:t,onVote:s,onComment:a,onReport:n,userVotes:l,comments:o,showLocation:i=!1})=>{var p;const[c,g]=u.useState(!1),[M,v]=u.useState(""),[w,R]=u.useState(!1),T=l[t.id],L=o.filter(y=>y.post_id===t.id),O=y=>{s(t.id,y)},N=()=>{M.trim()&&M.length<=200&&(a(t.id,M.trim()),v(""))},x=()=>{n(t.id),R(!0),setTimeout(()=>R(!1),3e3)},C=y=>{const E=new Date,z=new Date(y),P=Math.floor((E-z)/1e3);return P<60?"NOW":P<3600?`${Math.floor(P/60)}M`:P<86400?`${Math.floor(P/3600)}H`:`${Math.floor(P/86400)}D`};return t.vote_count<=-5?null:e.jsxs("div",{className:"py-4 border-b border-gray-300 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-navy-700 text-white flex items-center justify-center text-xs font-bold",children:t.username.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("div",{className:"font-bold text-sm",style:{color:((p=t.user_color)==null?void 0:p.value)||"#1e3a8a"},children:t.username})}),e.jsx("div",{className:"text-xs terminal-accent",children:i&&t.location.name?e.jsxs(e.Fragment,{children:["📍 ",t.location.name]}):t.location.nearestCity?e.jsxs(e.Fragment,{children:["📍 ",t.location.nearestCity]}):e.jsxs(e.Fragment,{children:[t.location.distance,"mi away"]})})]})]}),e.jsx("button",{onClick:x,className:`text-xs px-2 py-1 ${w?"text-gray-500":"text-red-600 hover:text-red-700"} focus:outline-none`,disabled:w,children:w?"✓":"🚩"})]}),e.jsx("div",{className:"mb-3 p-3 bg-white border-2 border-navy-700",children:e.jsx("div",{className:"terminal-text text-sm font-mono",children:t.content})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>O("up"),className:`px-2 py-1 text-sm ${T===1?"text-green-600 font-bold":"text-gray-600 hover:text-green-600"} focus:outline-none`,children:["▲ ",t.upvotes]}),e.jsxs("button",{onClick:()=>O("down"),className:`px-2 py-1 text-sm ${T===-1?"text-red-600 font-bold":"text-gray-600 hover:text-red-600"} focus:outline-none`,children:["▼ ",t.downvotes]}),e.jsxs("div",{className:`px-2 py-1 text-xs font-bold ${t.vote_count>0?"text-green-600":t.vote_count<0?"text-red-600":"text-gray-600"}`,children:[t.vote_count>0?"+":"",t.vote_count]})]}),e.jsxs("button",{onClick:()=>g(!c),className:"px-2 py-1 text-sm text-gray-600 hover:text-navy-700 focus:outline-none",children:["💬 ",L.length]})]}),c&&e.jsxs("div",{className:"mt-4 space-y-3 border-t-2 border-navy-700 pt-4",children:[L.map(y=>{var E;return e.jsxs("div",{className:"bg-gray-100 border-2 border-navy-700 p-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("div",{className:"w-4 h-4 bg-navy-700 text-white flex items-center justify-center text-xs font-bold",children:y.username.charAt(0)}),e.jsx("span",{className:"font-bold text-xs",style:{color:((E=y.user_color)==null?void 0:E.value)||"#1e3a8a"},children:y.username}),e.jsx("span",{className:"text-xs terminal-accent",children:C(y.created_at)})]}),e.jsx("div",{className:"terminal-text text-xs font-mono pl-6",children:y.content})]},y.id)}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("textarea",{value:M,onChange:y=>v(y.target.value),placeholder:"Add a comment...",className:"flex-1 h-16 px-2 py-1 terminal-input text-xs font-mono focus:outline-none focus:ring-2 focus:ring-navy-700 resize-none",maxLength:200}),e.jsx("button",{onClick:N,disabled:!M.trim(),className:"px-3 py-1 terminal-button text-xs font-bold hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-700 disabled:terminal-button:disabled",children:"Send"})]}),e.jsxs("div",{className:"text-xs terminal-accent",children:[M.length,"/200 characters"]})]})]})},ht=()=>{var he;const[t,s]=u.useState([]),[a,n]=u.useState([]),[l,o]=u.useState([]),[i,c]=u.useState(""),[g,M]=u.useState(null),[v,w]=u.useState(null),[R,T]=u.useState(navigator.onLine),[L,O]=u.useState(!1),[N,x]=u.useState("hot"),[C,p]=u.useState(""),[y,E]=u.useState(!1),[z,P]=u.useState(!1),[X,V]=u.useState(null),[Ae,ie]=u.useState(!1),[A,ce]=u.useState(10),[_e,Pe]=u.useState({posts:[],comments:[]});u.useState(Date.now()),u.useRef(null);const[Ee,Te]=u.useState(0),[Le,Oe]=u.useState(0),[Re,De]=u.useState(0),[Ie,ke]=u.useState(0),[K,me]=u.useState(20),[B,de]=u.useState(!1);u.useRef(null);const[Y,He]=u.useState(null);u.useState(null);const ge=nt();u.useEffect(()=>{const m=localStorage.getItem("riprap_user");m?M(JSON.parse(m)):O(!0);const d=be();ce(d.locationRadius),d.customLocation&&(V(d.customLocation),p(d.customLocation.name))},[]),u.useEffect(()=>{if(!g)return;(async()=>{try{await J(),ue()}catch(h){console.error("Failed to initialize app:",h)}const f=be();if(f.customLocation)w(f.customLocation),p(f.customLocation.name),console.log("Using saved custom location:",f.customLocation);else if(navigator.geolocation)navigator.geolocation.getCurrentPosition(h=>{const b=h.coords.latitude,j=h.coords.longitude;w({lat:b,lng:j}),p(Ce(b,j)),console.log("GPS location acquired:",{lat:b,lng:j})},h=>{console.error("GPS location failed:",h.message);const b=H["cape-cod-ma"];w(b),p(`${b.name} (Default)`)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5});else{console.warn("Geolocation not supported");const h=H["cape-cod-ma"];w(h),p(`${h.name} (Default)`)}})();const d=()=>T(!0),r=()=>T(!1);return window.addEventListener("online",d),window.addEventListener("offline",r),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",r)}},[g]),u.useEffect(()=>{g&&t&&a&&Be()},[t,a,g,l]),u.useEffect(()=>{A!==10&&ne(X,A)},[A,X]),u.useEffect(()=>{if(!(!g||!v))return J(),ue(),()=>{Y&&ae.unsubscribe(Y)}},[g,v,A,N]),u.useEffect(()=>{const m=()=>{if(N==="coastwide")return;const d=window.pageYOffset||document.documentElement.scrollTop,r=document.documentElement.scrollHeight,f=window.innerHeight;d+f>=r-1e3&&!B&&(de(!0),setTimeout(()=>{me(h=>h+10),de(!1)},500))};return window.addEventListener("scroll",m),()=>window.removeEventListener("scroll",m)},[N,B]),u.useEffect(()=>{me(20)},[N]);const Ve=(m,d)=>{const r=st(m,d);M(r),O(!1)},Be=()=>{if(!g||!t||!a)return;const m=t.filter(r=>r.username===g.screenName),d=a.filter(r=>r.username===g.screenName);Pe({posts:m,comments:d})},Ye=async m=>{m?(w(m),V(m),p(m.name),ne(m,A)):"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(d=>{const r={lat:d.coords.latitude,lng:d.coords.longitude};w(r),V(null);const f=Ce(r.lat,r.lng);p(f),ne(null,A)},()=>{console.error("Failed to get current location"),V(null)})},J=async()=>{if(v)try{const m=await F.getNearbyPosts(v.lat,v.lng,A),d=q(m);s(d);const r=d.map(b=>b.id),f=await Ne.getVotesForPosts(r,ge);o(f);const h=[];for(const b of d){const j=await te.getComments(b.id);h.push(...j)}n(h)}catch(m){console.error("Error loading posts:",m)}},ue=()=>{if(!v)return;Y&&ae.unsubscribe(Y);const m=ae.subscribeToNearbyPosts(v.lat,v.lng,A,d=>{s(r=>{const f=[d,...r];return q(f)})},d=>{s(r=>{const f=r.map(h=>h.id===d.id?d:h);return q(f)})});He(m)},q=m=>{const d=[...m];switch(N){case"newest":case"new":return d.sort((r,f)=>new Date(f.created_at)-new Date(r.created_at));case"oldest":return d.sort((r,f)=>new Date(r.created_at)-new Date(f.created_at));case"hot":case"topVoted":return d.sort((r,f)=>(f.vote_count||0)-(r.vote_count||0));case"mostComments":return d.sort((r,f)=>(f.comment_count||0)-(r.comment_count||0));case"closest":return d.sort((r,f)=>(r.distance_miles||0)-(f.distance_miles||0));default:return d}},Je=()=>{if(N==="coastwide")return t.map(h=>({...h,location:{...h.location,distance:v?Math.round(D(v.lat,v.lng,h.location.lat,h.location.lng)*10)/10:0,nearestCity:h.location.nearestCity||se(h.location.lat,h.location.lng),name:h.location.nearestCity||se(h.location.lat,h.location.lng)}})).filter(h=>h.location.lng>-82&&h.location.lng<-66).sort((h,b)=>{const j=a.filter(ee=>ee.post_id===h.id).length,Z=a.filter(ee=>ee.post_id===b.id).length,Q=(Date.now()-new Date(h.created_at))/(1e3*60*60),xe=(Date.now()-new Date(b.created_at))/(1e3*60*60),I=h.vote_count+j*3-Q*.05;return b.vote_count+Z*3-xe*.05-I}).slice(0,3);if(!v)return t.slice(0,K);const m=X||v;let d=t.filter(r=>r.location.lat&&r.location.lng?D(m.lat,m.lng,r.location.lat,r.location.lng)<=A:!0);return d=d.map(r=>({...r,location:{...r.location,distance:Math.round(D((m==null?void 0:m.lat)||0,(m==null?void 0:m.lng)||0,r.location.lat,r.location.lng)*10)/10,nearestCity:r.location.nearestCity||se(r.location.lat,r.location.lng)}})),N==="hot"?d.sort((r,f)=>{const h=a.filter(I=>I.post_id===r.id).length,b=a.filter(I=>I.post_id===f.id).length,j=(Date.now()-new Date(r.created_at))/(1e3*60*60),Z=(Date.now()-new Date(f.created_at))/(1e3*60*60),Q=r.vote_count+h*2-j*.1;return f.vote_count+b*2-Z*.1-Q}):d.sort((r,f)=>new Date(f.created_at)-new Date(r.created_at)),d.slice(0,K)},We=async()=>{if(!i.trim()||!g||!v)return;const m=we(Ee,$.POST_COOLDOWN,Re,$.MAX_POSTS_PER_HOUR,36e5);if(!m.allowed){alert(`Please wait ${m.remainingTime} seconds before posting again.`);return}const d=rt(i.trim());if(!d.allowed){alert(`Post blocked: ${d.issues.join(", ")}`);return}try{await F.createPost(i.trim(),g.screenName,g.color,v.lat,v.lng,C),c(""),E(!1),await J(),Te(Date.now()),De(r=>r+1)}catch(r){console.error("Failed to create post:",r),alert("Failed to create post. Please try again.")}},$e=async(m,d)=>{if(!g)return;const r=we(Le,$.VOTE_COOLDOWN,Ie,$.MAX_VOTES_PER_MINUTE,6e4);if(!r.allowed){console.log(`Vote rate limited: ${r.remainingTime}s remaining`);return}try{const f=l[m]||0;let h=0;d==="up"?h=1:d==="down"&&(h=-1);const b=f===h?0:h;await Ne.castVote(m,ge,b),o(j=>({...j,[m]:b})),await J(),Oe(Date.now()),ke(j=>j+1)}catch(f){console.error("Failed to vote:",f)}},Fe=async(m,d)=>{if(g)try{await te.createComment(m,d,g.screenName,g.color);const r=[];for(const f of t){const h=await te.getComments(f.id);r.push(...h)}n(r)}catch(r){console.error("Failed to comment:",r)}},Ue=m=>{console.log("Post reported:",m)},W=Je();return L?e.jsx(ct,{onUsernameSet:Ve}):e.jsxs("div",{className:"min-h-screen bg-gray-50 terminal-text overflow-x-hidden",children:[e.jsx(mt,{isOpen:Ae,onClose:()=>ie(!1),user:g,userStats:_e}),e.jsx(dt,{isOpen:z,onClose:()=>P(!1),onLocationSet:Ye,currentLocation:v}),e.jsx(gt,{isOpen:y,onClose:()=>E(!1),onSubmit:We,newPostContent:i,setNewPostContent:c,isOnline:R}),e.jsx("button",{onClick:()=>E(!0),className:"fixed bottom-4 right-4 sm:bottom-6 sm:right-6 w-12 h-12 sm:w-14 sm:h-14 bg-navy-700 text-white rounded-full shadow-lg hover:bg-navy-800 focus:outline-none focus:ring-2 focus:ring-navy-300 flex items-center justify-center text-xl sm:text-2xl z-40",style:{maxWidth:"calc(100vw - 2rem)"},title:"Create new post",children:"+"}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-0",children:[e.jsx("div",{className:"terminal-header sticky top-0 z-40 p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-2xl font-extrabold tracking-widest",children:"RIPRAP"}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"text-xs",children:"Share the Shore, Spill the Lore"})})]}),e.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2",children:e.jsx("button",{onClick:()=>ie(!0),className:"flex items-center space-x-1 text-xs sm:text-sm font-bold px-3 py-2 bg-white border-2 border-navy-600 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-navy-300 shadow-sm",style:{color:((he=g==null?void 0:g.color)==null?void 0:he.value)||"#1e3a8a"},children:e.jsx("span",{children:g==null?void 0:g.screenName})})})]})}),e.jsxs("div",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"p-3 terminal-card",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>P(!0),className:"w-full text-left hover:bg-navy-50 focus:outline-none focus:ring-2 focus:ring-navy-300 rounded p-2",children:[e.jsx("div",{className:"text-sm font-bold terminal-text mb-1",children:"📍 Local Area:"}),e.jsx("div",{className:"text-xs terminal-accent",children:C}),e.jsx("div",{className:"text-xs text-navy-600 mt-1",children:"Click to change location"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-bold terminal-text block",children:["Search Radius: ",A," miles"]}),e.jsx("input",{type:"range",min:"5",max:"100",step:"5",value:A,onChange:m=>ce(parseInt(m.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-navy"}),e.jsxs("div",{className:"flex justify-between text-xs terminal-accent",children:[e.jsx("span",{children:"5 mi"}),e.jsxs("span",{children:["Show posts within ",A," miles"]}),e.jsx("span",{children:"100 mi"})]})]})]})}),e.jsxs("div",{className:"terminal-card p-3",children:[e.jsx("div",{className:"text-sm font-bold terminal-text mb-2",children:"Sort by:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:()=>x("hot"),className:`px-3 py-2 text-sm font-bold border-2 ${N==="hot"?"terminal-button":"border-navy-600 bg-white text-navy-600 hover:bg-navy-50"} focus:outline-none focus:ring-2 focus:ring-navy-600`,children:"🔥 Hot"}),e.jsx("button",{onClick:()=>x("new"),className:`px-3 py-2 text-sm font-bold border-2 ${N==="new"?"terminal-button":"border-navy-600 bg-white text-navy-600 hover:bg-navy-50"} focus:outline-none focus:ring-2 focus:ring-navy-600`,children:"⭐ New"}),e.jsx("button",{onClick:()=>x("coastwide"),className:`px-3 py-2 text-sm font-bold border-2 ${N==="coastwide"?"terminal-button":"border-navy-600 bg-white text-navy-600 hover:bg-navy-50"} focus:outline-none focus:ring-2 focus:ring-navy-600`,children:"🌊 Coastwide"})]}),N==="coastwide"&&e.jsx("div",{className:"text-xs terminal-accent mt-2",children:"Top 3 posts from across the East Coast"})]})]}),e.jsx("div",{className:"p-4",children:W.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🎣"}),e.jsx("div",{className:"text-sm font-bold terminal-text mb-2",children:N==="coastwide"?"No trending posts found":"No posts in your area"}),e.jsx("div",{className:"text-xs terminal-accent",children:N==="coastwide"?"Check back later for trending discussions!":"Be the first to share what's happening on the water!"})]}):e.jsxs(e.Fragment,{children:[W.map((m,d)=>e.jsxs("div",{children:[e.jsx(ut,{post:m,onVote:$e,onComment:Fe,onReport:Ue,userVotes:l,comments:a,showLocation:N==="coastwide"}),N==="coastwide"&&d<W.length-1&&e.jsx("div",{className:"border-t-2 border-navy-300 my-4"})]},m.id)),B&&N!=="coastwide"&&e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-sm terminal-accent",children:"Loading more posts..."})}),!B&&N!=="coastwide"&&W.length>=K&&e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-xs terminal-accent",children:"Scroll down for more posts"})})]})}),e.jsxs("div",{className:"p-4 text-center text-xs terminal-accent bg-gray-100 border-t-2 border-navy-700",children:[e.jsx("div",{children:"🎣 Tight lines and good catches!"}),e.jsx("div",{children:"Anonymous • Location-based • Fishing community"})]})]})]})};le.createRoot(document.getElementById("root")).render(e.jsx(ze.StrictMode,{children:e.jsx(ht,{})}));
//# sourceMappingURL=index-956fb51d.js.map
